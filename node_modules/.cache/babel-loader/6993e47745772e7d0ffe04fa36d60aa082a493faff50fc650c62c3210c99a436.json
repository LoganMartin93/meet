{"ast":null,"code":"import NProgress from 'nprogress';\nimport mockData from './mock-data';\n\n/**\n *\n * @param {*} events:\n * The following function should be in the “api.js” file.\n * This function takes an events array, then uses map to create a new array with only locations.\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\n * The Set will remove all duplicates from the array.\n */\nexport const extractLocations = events => {\n  const extractedLocations = events.map(event => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl = window.location.protocol + \"//\" + window.location.host + window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\nconst checkToken = async accessToken => {\n  const response = await fetch(`https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`);\n  const result = await response.json();\n  return result;\n};\n\n/**\n *\n * This function will fetch the list of all events\n */\nexport const getEvents = async () => {\n  if (window.location.href.startsWith('http://localhost')) {\n    return mockData;\n  }\n  if (!navigator.onLine) {\n    const events = localStorage.getItem(\"lastEvents\");\n    NProgress.done();\n    return events ? JSON.parse(events) : [];\n  }\n  const token = await getAccessToken();\n  if (token) {\n    removeQuery();\n    const url = \"https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/get-events\" + \"/\" + token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      NProgress.done();\n      localStorage.setItem(\"lastEvents\", JSON.stringify(result.events));\n      return result.events;\n    } else return null;\n  }\n};\nconst getToken = async code => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(\"https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/token\" + '/' + encodeCode);\n  const {\n    access_token\n  } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n  return access_token;\n};\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n    if (!code) {\n      const response = await fetch('https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/get-auth-url');\n      const result = await response.json();\n      const {\n        authUrl\n      } = result;\n      return window.location.href = authUrl;\n    }\n    return code && getToken(code);\n  }\n  return accessToken;\n};","map":{"version":3,"names":["NProgress","mockData","extractLocations","events","extractedLocations","map","event","location","locations","Set","removeQuery","newurl","window","history","pushState","pathname","protocol","host","checkToken","accessToken","response","fetch","result","json","getEvents","href","startsWith","navigator","onLine","localStorage","getItem","done","JSON","parse","token","getAccessToken","url","setItem","stringify","getToken","code","encodeCode","encodeURIComponent","access_token","tokenCheck","error","removeItem","searchParams","URLSearchParams","search","get","authUrl"],"sources":["/Users/loganmartin/Desktop/meetUpApp/meet/src/api.js"],"sourcesContent":["import NProgress from 'nprogress';\nimport mockData from './mock-data';\n\n/**\n *\n * @param {*} events:\n * The following function should be in the “api.js” file.\n * This function takes an events array, then uses map to create a new array with only locations.\n * It will also remove all duplicates by creating another new array using the spread operator and spreading a Set.\n * The Set will remove all duplicates from the array.\n */\nexport const extractLocations = (events) => {\n  const extractedLocations = events.map((event) => event.location);\n  const locations = [...new Set(extractedLocations)];\n  return locations;\n};\n\nconst removeQuery = () => {\n  let newurl;\n  if (window.history.pushState && window.location.pathname) {\n    newurl =\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      window.location.pathname;\n    window.history.pushState(\"\", \"\", newurl);\n  } else {\n    newurl = window.location.protocol + \"//\" + window.location.host;\n    window.history.pushState(\"\", \"\", newurl);\n  }\n};\n\nconst checkToken = async (accessToken) => {\n  const response = await fetch(\n    `https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=${accessToken}`\n  );\n  const result = await response.json();\n  return result;\n};\n\n/**\n *\n * This function will fetch the list of all events\n */\nexport const getEvents = async () => {\n  if (window.location.href.startsWith('http://localhost')) {\n    return mockData;\n  }\n  if (!navigator.onLine) {\n    const events = localStorage.getItem(\"lastEvents\");\n    NProgress.done();\n    return events ? JSON.parse(events) : [];\n\n  }\n\n  const token = await getAccessToken();\n\n  if (token) {\n    removeQuery();\n    const url =  \"https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/get-events\" + \"/\" + token;\n    const response = await fetch(url);\n    const result = await response.json();\n    if (result) {\n      NProgress.done();\n      localStorage.setItem(\"lastEvents\", JSON.stringify(result.events));\n      return result.events;\n    } else return null; \n  }\n};\n\nconst getToken = async (code) => {\n  const encodeCode = encodeURIComponent(code);\n  const response = await fetch(\n    \"https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/token\" + '/' + encodeCode\n  );\n  const { access_token } = await response.json();\n  access_token && localStorage.setItem(\"access_token\", access_token);\n\n  return access_token;\n};\n\nexport const getAccessToken = async () => {\n  const accessToken = localStorage.getItem('access_token');\n  const tokenCheck = accessToken && (await checkToken(accessToken));\n\n  if (!accessToken || tokenCheck.error) {\n    await localStorage.removeItem(\"access_token\");\n    const searchParams = new URLSearchParams(window.location.search);\n    const code = await searchParams.get(\"code\");\n      if (!code) {\n        const response = await fetch(\n            'https://g0woxi8rqa.execute-api.us-west-1.amazonaws.com/dev/api/get-auth-url'\n        );\n        const result = await response.json();\n        const { authUrl } = result;\n        return (window.location.href = authUrl);\n      }\n      return code && getToken(code);\n      }\n  return accessToken;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}